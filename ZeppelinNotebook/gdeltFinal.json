{"paragraphs":[{"text":"import org.apache.spark.{SparkConf, SparkContext}\nimport org.apache.spark.sql.{DataFrame, SparkSession, SaveMode}\nimport org.apache.spark.input.PortableDataStream\nimport org.apache.spark.sql.functions._\nimport java.util.zip.ZipInputStream\nimport java.io.BufferedReader\nimport java.io.InputStreamReader\nimport com.datastax.spark.connector.cql.CassandraConnector\nimport org.apache.spark.sql.cassandra._\n\nimport org.apache.spark.rdd.RDD\n\nimport spark.implicits._\nval AWS_ID = \"ASIAX7FDIQZHSMLNALHR\"\nval AWS_KEY = \"BpNC2lB0K7R2uX9wWD1VmCWAZ4fOMAJzBx3hzGSL\"\nval AWS_TOKEN = \"FwoGZXIvYXdzENL//////////wEaDP7CH0eBtzc01iA9CCK/AUrQVblR9yYD350MQZQQMKToHw1grQJjkdlkIuYU6WYPnKO/94MIW8vEPY0q2vXRFYfgQAvYrzoyP2McL5HsM/AdGVT9K4WHdHK/WICGSp6JVnKI+EG9augjXoFkLrYZzdeCwucCYv8mFmPuTgSmflLP3Uo3AsZYcgznGWcojlO34vnGlecJubW7bfnu8mYKeb7XW0rbLvjlF21vZvEIRu0FMzsmvmJUwHXA0xWHCxZ8BrLs2HXjMejB9eSNYv86KLnPqvEFMi0extQJcTLuOIJ15fb+QxkYc2BnoQSsF2Fq3YNCzBndx5tZGzE0tuSJTb66TkQ=\"\nval s3_name = \"projet-gdelt-2019\"\n\nsc.hadoopConfiguration.set(\"fs.s3a.aws.credentials.provider\", \"org.apache.hadoop.fs.s3a.TemporaryAWSCredentialsProvider\")\nsc.hadoopConfiguration.set(\"fs.s3a.access.key\", AWS_ID)\nsc.hadoopConfiguration.set(\"fs.s3a.secret.key\", AWS_KEY)\nsc.hadoopConfiguration.set(\"fs.s3a.session.token\", AWS_TOKEN)","user":"anonymous","dateUpdated":"2020-01-24T08:40:40+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.{SparkConf, SparkContext}\nimport org.apache.spark.sql.{DataFrame, SparkSession, SaveMode}\nimport org.apache.spark.input.PortableDataStream\nimport org.apache.spark.sql.functions._\nimport java.util.zip.ZipInputStream\nimport java.io.BufferedReader\nimport java.io.InputStreamReader\nimport com.datastax.spark.connector.cql.CassandraConnector\nimport org.apache.spark.sql.cassandra._\nimport org.apache.spark.rdd.RDD\nimport spark.implicits._\nAWS_ID: String = ASIAX7FDIQZHSMLNALHR\nAWS_KEY: String = BpNC2lB0K7R2uX9wWD1VmCWAZ4fOMAJzBx3hzGSL\nAWS_TOKEN: String = FwoGZXIvYXdzENL//////////wEaDP7CH0eBtzc01iA9CCK/AUrQVblR9yYD350MQZQQMKToHw1grQJjkdlkIuYU6WYPnKO/94MIW8vEPY0q2vXRFYfgQAvYrzoyP2McL5HsM/AdGVT9K4WHdHK/WICGSp6JVnKI+EG9augjXoFkLrYZzdeCwucCYv8mFmPuTgSmflLP3Uo3AsZYcgznGWcojlO34v..."}]},"apps":[],"jobName":"paragraph_1579854914674_-1198523651","id":"20200123-085417_320799483","dateCreated":"2020-01-24T08:35:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:239","dateFinished":"2020-01-24T08:41:28+0000","dateStarted":"2020-01-24T08:40:41+0000"},{"text":"// ********************* QUERY 1 *********************","user":"anonymous","dateUpdated":"2020-01-24T08:41:28+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1579854914680_-641631336","id":"20200123-101154_1340086794","dateCreated":"2020-01-24T08:35:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:240","dateFinished":"2020-01-24T08:41:29+0000","dateStarted":"2020-01-24T08:41:28+0000"},{"text":"val query1 = spark.read\n      .cassandraFormat(\"event_by_day\", \"gdelt\")\n      .load()","user":"anonymous","dateUpdated":"2020-01-24T08:41:29+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"query1: org.apache.spark.sql.DataFrame = [date: string, country: string ... 2 more fields]\n"}]},"apps":[],"jobName":"paragraph_1579854914681_1032753582","id":"20200123-094703_329133696","dateCreated":"2020-01-24T08:35:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:241","dateFinished":"2020-01-24T08:41:33+0000","dateStarted":"2020-01-24T08:41:29+0000"},{"text":"// Display number of events by country\nz.show(query1\n.select(\"country\",\"count_events\")\n.groupBy(\"country\").agg(sum(\"count_events\")))","user":"anonymous","dateUpdated":"2020-01-24T08:45:39+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"pieChart","height":759.967,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"country":"string","sum(count_events)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"pieChart":{}},"commonSetting":{},"keys":[{"name":"country","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"sum(count_events)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"country\tsum(count_events)\nLT\t1925\nCI\t68397\nPC\t13\nFI\t66610\nIC\t7470\nPM\t88097\nSC\t253\nPU\t1539\nNS\t3236\nRO\t298808\nSL\t4118\nLA\t5209\nNL\t109316\nSB\t4\nMN\t4118\nAM\t68428\nPL\t245794\nPS\t2035\nRE\t3276\nUV\t61758\nMK\t209671\nAA\t458\nAY\t2856\nDR\t5544\nMX\t632736\nPF\t314\nYI\t1358\nGL\t3405\nTV\t117\nBP\t796\nSM\t407\nCN\t1000\nFG\t214\nTI\t5282\nSW\t203617\nAV\t519\nBU\t105163\nCG\t31637\nNT\t5\nHR\t76430\nLI\t5951\nSV\t241\nBX\t4701\nNP\t29990\nWE\t101719\nTU\t642620\nSO\t54119\nVQ\t793\nRQ\t23912\nPG\t135\nRI\t89628\nGG\t15929\nGH\t50798\nBC\t2620\nBN\t3915\nCV\t1645\nHK\t15784\nNH\t2610\nMI\t8062\nTW\t39838\nGV\t10690\nSU\t90755\nBD\t2672\nWI\t1153\nTO\t12373\nLY\t69888\nID\t343780\nFK\t11\nIV\t21615\nTP\t381\nAU\t60408\nGZ\t27873\nPK\t214408\nSA\t252247\nBL\t56703\nBM\t18203\nCA\t611062\nCT\t9423\nNE\t467\nUZ\t9794\nGB\t21102\nMT\t30391\nBR\t539114\nKZ\t26628\nHO\t44298\nBY\t8525\nNC\t390\nVT\t7337\nEN\t16173\nGK\t2615\nGT\t43603\nMD\t34997\nRB\t70953\nIO\t31\nGJ\t2516\nSP\t390521\nBH\t4136\nEC\t30575\nES\t20788\nIR\t352315\nMO\t64073\nNR\t493\nVI\t469\nPO\t101465\nMR\t8340\nVE\t704881\nOD\t7936\nMB\t1690\nZA\t9895\nJN\t5\nSF\t100688\nKR\t254\nWQ\t9\nTZ\t10349\nWA\t6214\nRS\t1295657\nUS\t7314414\nAQ\t408\nLH\t49536\nTS\t43409\nEK\t1911\nAL\t66527\nMY\t46454\nIN\t542518\nJM\t18087\nGM\t506910\nBK\t9698\nAE\t71351\nKV\t24138\nCM\t18629\nRW\t15269\nMJ\t7224\nFR\t655243\nAJ\t49671\nDA\t83711\nCH\t839738\nMG\t7502\nTN\t1527\nGQ\t3134\nNU\t34463\nZI\t72863\nKT\t142\nTL\t117\nWF\t8\nGR\t408597\nUP\t402277\nGI\t4734\nPA\t21495\nTD\t6621\nRP\t109485\nAG\t27038\nDJ\t8400\nMC\t2191\nHA\t13101\nBA\t21137\nJO\t92532\nET\t25279\nSG\t15058\nEI\t231392\nBF\t15492\nCU\t65579\nIT\t624498\nMV\t5036\nFO\t104\nSE\t1501\nVM\t81487\nBG\t103488\nFJ\t11917\nWS\t3070\nKU\t47600\nUK\t1315786\nCJ\t1581\nFM\t605\nLO\t20818\nCW\t250\nMH\t2466\nMU\t33854\nOS\t15072\nPE\t113122\nLS\t921\nHQ\t7\nMZ\t14256\nLG\t29450\nLE\t123490\nQA\t78879\nDO\t3090\nTH\t116703\nEG\t350343\nSH\t93\nCS\t9094\nMF\t411\nGY\t6130\nFP\t397\nCE\t28045\nVC\t1667\nSN\t75399\nTX\t8129\nRN\t402\nCB\t13666\nNZ\t51227\nBT\t2378\nKN\t215961\nYM\t95924\nHU\t65262\nKE\t107590\nCY\t42563\nSI\t21114\nML\t58781\nEZ\t48981\nGP\t5963\nUG\t16725\nGA\t6245\nAS\t325975\nBE\t237236\nMA\t6330\nWZ\t1138\nAC\t1711\nKS\t252662\nNI\t201797\nAN\t3621\nKG\t12308\nTT\t2182\nNO\t72035\nSY\t563457\nBO\t41529\nER\t4395\nJQ\t2\nCO\t161050\nIM\t180\nIZ\t185238\nUY\t23119\nOC\t787\nNG\t44806\nJE\t16745\nCF\t63939\nAR\t119902\nEU\t2\nRM\t656\nTK\t820\nLU\t13992\nSZ\t187385\nNF\t15\nIS\t1354607\nMP\t33455\nAF\t236103\nJA\t283529\nBB\t2265\nCQ\t141\nPP\t2881\nCD\t53430\nAO\t16391\nST\t1751\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1579854914682_-356890493","id":"20200123-085546_800023469","dateCreated":"2020-01-24T08:35:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:242","dateFinished":"2020-01-24T08:46:00+0000","dateStarted":"2020-01-24T08:45:39+0000"},{"text":"// Display number of events by day\nz.show(query1\n.select(\"date\",\"count_events\")\n.groupBy(\"date\")\n.agg(sum(\"count_events\").alias(\"number of events\"))\n.filter($\"date\".startsWith(\"2019\")))","user":"anonymous","dateUpdated":"2020-01-24T08:41:51+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"date":"string","number of events":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"date","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"number of events","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"date\tnumber of events\n20190112\t735304\n20190111\t1032446\n20190113\t661828\n20190126\t748513\n20190121\t984998\n20190123\t1145431\n20190109\t1143080\n20190115\t1210917\n20190130\t1108423\n20190108\t1067380\n20190102\t734622\n20190106\t589698\n20190119\t825287\n20190128\t963920\n20190118\t1099920\n20190107\t887144\n20190125\t1105917\n20190122\t1067165\n20190104\t853252\n20190127\t708400\n20190101\t524871\n20190131\t1070550\n20190110\t1133001\n20190120\t665556\n20190105\t586099\n20190114\t1037401\n20190129\t1171231\n20190103\t866156\n20190124\t1241365\n20190117\t1132032\n20190116\t1204444\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1579854914682_450835396","id":"20200123-085639_223947056","dateCreated":"2020-01-24T08:35:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:243","dateFinished":"2020-01-24T08:41:58+0000","dateStarted":"2020-01-24T08:41:51+0000"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"date":"string","number of events":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"date","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"number of events","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579855675548_2051330206","id":"20200124-084755_90747619","dateCreated":"2020-01-24T08:47:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11835","text":"// Display number of events by day\nz.show(query1\n.filter($\"country\" === \"VE\")\n.select(\"date\",\"count_events\")\n.groupBy(\"date\")\n.agg(sum(\"count_events\").alias(\"number of events\"))\n.filter($\"date\".startsWith(\"2019\")))","dateUpdated":"2020-01-24T08:53:33+0000","dateFinished":"2020-01-24T08:53:36+0000","dateStarted":"2020-01-24T08:53:33+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"date\tnumber of events\n20190112\t5203\n20190111\t9018\n20190113\t12986\n20190126\t70998\n20190121\t13836\n20190123\t43062\n20190109\t13592\n20190115\t7340\n20190130\t64253\n20190108\t5352\n20190102\t4755\n20190106\t3292\n20190119\t3473\n20190128\t37066\n20190118\t7140\n20190107\t3635\n20190125\t71741\n20190122\t19707\n20190104\t4009\n20190127\t48041\n20190101\t1817\n20190131\t52865\n20190110\t18781\n20190120\t3119\n20190105\t12746\n20190114\t7618\n20190129\t42450\n20190103\t7051\n20190124\t91476\n20190117\t6997\n20190116\t7088\n"},{"type":"TEXT","data":""}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579856152939_1647443124","id":"20200124-085552_838281420","dateCreated":"2020-01-24T08:55:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:13313","text":"%md\n<img src=\"https://ichef.bbci.co.uk/images/ic/720x405/p06yxcnj.jpg\"/>","dateUpdated":"2020-01-24T09:02:27+0000","dateFinished":"2020-01-24T09:02:29+0000","dateStarted":"2020-01-24T09:02:27+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<img src=\"https://ichef.bbci.co.uk/images/ic/720x405/p06yxcnj.jpg\"/>\n</div>"}]}},{"text":"// ************************ QUERY 2 ********************************","user":"anonymous","dateUpdated":"2020-01-24T08:41:58+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579854914683_-1991600313","id":"20200123-201336_1756132991","dateCreated":"2020-01-24T08:35:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:244","dateFinished":"2020-01-24T08:41:58+0000","dateStarted":"2020-01-24T08:41:58+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"val query2 = spark.read\n      .cassandraFormat(\"country_events\", \"gdelt\")\n      .load()","user":"anonymous","dateUpdated":"2020-01-24T08:41:58+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"query2: org.apache.spark.sql.DataFrame = [country: string, year: int ... 4 more fields]\n"}]},"apps":[],"jobName":"paragraph_1579854914684_2029131232","id":"20200123-103654_1317580592","dateCreated":"2020-01-24T08:35:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:245","dateFinished":"2020-01-24T08:41:59+0000","dateStarted":"2020-01-24T08:41:59+0000"},{"text":"// Display number of mentions / day for Italy\nz.show(query2\n.filter($\"country\"===\"FR\")\n.select(\"day\",\"num_mentions\",\"event\")\n.groupBy(\"day\").agg(sum(\"num_mentions\").alias(\"num mentions\")))","user":"anonymous","dateUpdated":"2020-01-24T09:11:09+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"country":"string","number of mentions":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"pieChart":{},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"day","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"num mentions","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"day\tnum mentions\n31\t4\n28\t3\n26\t3\n27\t3\n12\t4\n22\t4\n1\t2\n13\t3\n6\t3\n16\t3\n3\t3\n20\t3\n5\t4\n19\t3\n15\t3\n9\t3\n17\t3\n4\t3\n8\t3\n23\t4\n7\t3\n10\t3\n25\t3\n24\t3\n29\t3\n21\t3\n11\t3\n14\t3\n2\t5\n30\t3\n18\t3\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1579854914684_1984035886","id":"20200123-200718_891033695","dateCreated":"2020-01-24T08:35:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:246","dateFinished":"2020-01-24T09:11:11+0000","dateStarted":"2020-01-24T09:11:09+0000"},{"text":"// Compare number of mentions / day for US, FR, UK, KZ\nz.show(query2\n.filter($\"country\"===\"US\" || $\"country\"===\"FR\" || $\"country\"===\"UK\" || $\"country\"===\"KZ\")\n.select(\"country\",\"day\",\"num_mentions\")\n.groupBy(\"country\",\"day\")\n.agg(sum(\"num_mentions\").alias(\"num mentions\")))","user":"anonymous","dateUpdated":"2020-01-24T08:42:03+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"country":"string","day":"string","sum(num_mentions)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"day","index":1,"aggr":"sum"}],"groups":[{"name":"country","index":0,"aggr":"sum"}],"values":[{"name":"num mentions","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"country\tday\tnum mentions\nFR\t1\t2\nKZ\t12\t2\nFR\t27\t3\nUK\t7\t4\nUK\t12\t4\nFR\t25\t3\nUK\t13\t3\nUS\t19\t4\nKZ\t16\t2\nFR\t24\t3\nUK\t8\t3\nKZ\t20\t2\nUS\t12\t4\nKZ\t21\t2\nFR\t10\t3\nFR\t12\t4\nKZ\t29\t3\nUS\t16\t4\nUK\t22\t3\nUS\t18\t4\nFR\t5\t4\nKZ\t22\t4\nUS\t30\t4\nFR\t2\t5\nUS\t4\t4\nFR\t7\t3\nUK\t31\t4\nUS\t15\t4\nKZ\t6\t1\nUK\t24\t4\nUK\t27\t4\nUS\t29\t4\nUS\t26\t4\nUK\t26\t3\nFR\t31\t4\nFR\t4\t3\nUK\t3\t3\nKZ\t13\t1\nUS\t13\t4\nFR\t20\t3\nUS\t10\t4\nFR\t21\t3\nFR\t15\t3\nUS\t9\t4\nUK\t10\t3\nUS\t24\t4\nFR\t19\t3\nKZ\t25\t3\nUK\t6\t3\nFR\t13\t3\nFR\t14\t3\nFR\t28\t3\nUS\t17\t4\nUS\t8\t4\nKZ\t10\t2\nUS\t11\t4\nUK\t25\t4\nKZ\t19\t2\nKZ\t5\t1\nUS\t21\t4\nKZ\t14\t1\nKZ\t1\t1\nFR\t8\t3\nUK\t28\t3\nKZ\t24\t3\nKZ\t28\t2\nUK\t23\t3\nFR\t30\t3\nUS\t23\t4\nUK\t18\t4\nKZ\t2\t1\nKZ\t18\t2\nUK\t30\t4\nUK\t17\t4\nKZ\t8\t2\nKZ\t27\t2\nUK\t20\t3\nKZ\t23\t2\nUS\t2\t4\nFR\t6\t3\nKZ\t17\t2\nUS\t6\t4\nKZ\t3\t1\nUS\t31\t4\nUK\t19\t4\nUK\t9\t3\nUK\t16\t3\nUK\t5\t3\nUS\t7\t4\nKZ\t15\t1\nUK\t15\t4\nFR\t16\t3\nFR\t17\t3\nKZ\t7\t2\nKZ\t30\t3\nKZ\t26\t2\nUS\t5\t4\nUS\t20\t4\nFR\t18\t3\nKZ\t11\t2\nKZ\t31\t2\nUK\t21\t3\nUK\t11\t4\nUS\t14\t4\nUS\t27\t4\nUK\t2\t3\nFR\t11\t3\nFR\t22\t4\nUK\t4\t4\nFR\t23\t4\nFR\t26\t3\nUS\t22\t4\nUK\t1\t2\nUS\t28\t3\nUK\t29\t3\nUS\t25\t4\nKZ\t4\t2\nFR\t3\t3\nKZ\t9\t3\nUS\t1\t3\nFR\t29\t3\nUK\t14\t4\nUS\t3\t4\nFR\t9\t3\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1579854914686_-184157278","id":"20200123-203128_1941195319","dateCreated":"2020-01-24T08:35:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:247","dateFinished":"2020-01-24T08:42:06+0000","dateStarted":"2020-01-24T08:42:03+0000"},{"text":"// ********************* Query 3 ************************","user":"anonymous","dateUpdated":"2020-01-24T08:42:06+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579854914686_-811581759","id":"20200123-204646_341299286","dateCreated":"2020-01-24T08:35:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:248","dateFinished":"2020-01-24T08:42:06+0000","dateStarted":"2020-01-24T08:42:06+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"val query3_article_by_theme = spark.read\n      .cassandraFormat(\"article_by_theme\", \"gdelt\")\n      .load()\n\nval query3_article_by_person = spark.read\n      .cassandraFormat(\"article_by_person\", \"gdelt\")\n      .load()\n\nval query3_article_by_location = spark.read\n      .cassandraFormat(\"article_by_location\", \"gdelt\")\n      .load()","user":"anonymous","dateUpdated":"2020-01-24T08:42:06+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"query3_article_by_theme: org.apache.spark.sql.DataFrame = [source_common_name: string, year: int ... 5 more fields]\nquery3_article_by_person: org.apache.spark.sql.DataFrame = [source_common_name: string, year: int ... 5 more fields]\nquery3_article_by_location: org.apache.spark.sql.DataFrame = [source_common_name: string, year: int ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1579854914687_-461682893","id":"20200123-205744_2053078793","dateCreated":"2020-01-24T08:35:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:249","dateFinished":"2020-01-24T08:42:07+0000","dateStarted":"2020-01-24T08:42:06+0000"},{"text":"// Spot number of sources that appear the most\nz.show(query3_article_by_theme.select(\"source_common_name\").groupBy(\"source_common_name\").agg(count(\"source_common_name\").alias(\"count source\")).orderBy(desc(\"count source\")))","user":"anonymous","dateUpdated":"2020-01-24T08:42:07+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"source_common_name":"string","count source":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"source_common_name\tcount source\nmsn.com\t2539\nyahoo.com\t2156\nindiatimes.com\t1704\nscotcampus.com\t1665\nsina.com.cn\t1606\nsina.com.tw\t1568\ndailymail.co.uk\t1561\nqq.com\t1525\neastmoney.com\t1428\nbusiness-standard.com\t1423\ntheguardian.com\t1396\nxinhuanet.com\t1391\nsputniknews.com\t1366\nelbalad.news\t1352\nindianexpress.com\t1339\ndw.com\t1270\nbaomoi.com\t1266\ndostor.org\t1259\nsfgate.com\t1255\nzazoom.it\t1249\nglobo.com\t1246\nthehindu.com\t1246\nbbc.com\t1244\ntribunnews.com\t1237\nuol.com.br\t1197\nudn.com\t1194\nsueddeutsche.de\t1160\nchron.com\t1148\nlratvakan.com\t1143\nnbcnews.com\t1143\nhaberler.com\t1137\nnytimes.com\t1118\nreuters.com\t1106\nthenews.com.pk\t1103\nstuff.co.nz\t1099\n163.com\t1086\nelpais.com\t1083\ndiariolibre.com\t1068\nvietgiaitri.com\t1058\nforbes.com\t1050\nnzherald.co.nz\t1041\nwashingtonpost.com\t1033\ninquirer.net\t1032\nvanguardngr.com\t1016\nwenxuecity.com\t1015\ncbc.ca\t1009\neuronews.com\t1001\ndawn.com\t970\nlarepublica.pe\t967\nltn.com.tw\t954\nseattletimes.com\t953\nthenationonlineng.net\t953\nria.ru\t939\nnews.makedonias.gr\t938\nhindustantimes.com\t933\npunchng.com\t930\ntucson.com\t923\ndailyrepublic.com\t921\nhoy.es\t919\npronews.gr\t919\naboluowang.com\t914\nbdnews24.com\t914\nsandiegouniontribune.com\t909\npagina12.com.ar\t908\nrt.com\t898\nahram.org.eg\t896\nchinanews.com\t894\nrg.ru\t894\nsmh.com.au\t884\ntimesofisrael.com\t877\nperfil.com\t874\nwelt.de\t873\nclarin.com\t872\nbrisbanetimes.com.au\t871\nstamfordadvocate.com\t870\ntimesnownews.com\t866\nregnum.ru\t866\nkalerkantho.com\t865\nindependent.ie\t862\npeople.com.cn\t862\nspecial.tass.ru\t859\ncharter97.org\t856\n20minutos.es\t855\nchina.org.cn\t855\nallafrica.com\t854\nkommersant.ru\t852\nelcomercio.es\t846\nsetn.com\t839\ntheage.com.au\t838\nbbc.co.uk\t836\nthestar.com\t834\ntass.ru\t831\nelconfidencial.com\t829\nactu.fr\t827\ndeccanchronicle.com\t826\nthetimes.co.uk\t824\nalwatanvoice.com\t819\nlmtonline.com\t814\nogunhaber.com\t813\naninews.in\t812\nyna.co.kr\t810\nfrance24.com\t807\nchina.com.cn\t806\ntribune.com.pk\t805\nlavanguardia.com\t802\neluniversal.com.mx\t802\nseattlepi.com\t802\nqianlong.com\t801\nindependent.co.uk\t799\nprokerala.com\t798\nepochtimes.com\t798\nchicagotribune.com\t797\nideal.es\t797\ntotalnews.com.ar\t796\nrtl.be\t795\nlarazon.es\t794\nnation.co.ke\t793\nndtv.com\t793\nbanglanews24.com\t793\nyangtse.com\t788\nthenational.ae\t788\ntribuneonlineng.com\t786\nchinatimes.com\t785\ngo.com\t784\nnewindianexpress.com\t784\neluniverso.com\t782\nmirror.co.uk\t782\njagonews24.com\t782\nchinesepress.com\t781\nleonoticias.com\t781\nbignewsnetwork.com\t780\njamaica-gleaner.com\t779\nsohu.com\t776\nsfchronicle.com\t775\njoins.com\t772\nantaranews.com\t772\nsify.com\t770\nkonhaber.com\t770\nf5haber.com\t768\ndiariovasco.com\t767\nammonnews.net\t766\ndiariosur.es\t766\nnhregister.com\t765\ndebate.com.mx\t762\ngulfnews.com\t761\nbjd.com.cn\t760\nsoftrock929.com\t759\nleparisien.fr\t753\norlandosentinel.com\t753\n24tv.ua\t749\nstraitstimes.com\t749\nalmasryalyoum.com\t748\nkaixian.tv\t746\nfinancialexpress.com\t746\nifeng.com\t745\nliputan6.com\t744\nctpost.com\t744\nbusinessinsider.com\t743\ntheglobeandmail.com\t740\nthetelegraph.com\t740\nelimparcial.com\t740\nstartribune.com\t739\nprensa-latina.cu\t739\ndaijiworld.com\t739\nthepeninsulaqatar.com\t738\nglobalnews.ca\t738\nlaopinion.com\t735\nthestar.com.my\t734\nhinet.net\t732\ncentralmaine.com\t732\nmiddletownpress.com\t731\npronedra.ru\t725\nynet.co.il\t725\ndiariosigloxxi.com\t724\nwsoctv.com\t724\nfreemalaysiatoday.com\t724\nirishtimes.com\t724\nfirstpost.com\t724\n1688.com.au\t722\nmaville.com\t721\nnews-front.info\t719\nstandardmedia.co.ke\t719\nem.com.br\t718\njapantimes.co.jp\t718\njamaicaobserver.com\t717\neldiariomontanes.es\t716\nmerkur.de\t715\ndiodeo.com\t714\nfinanznachrichten.de\t713\norissapost.com\t713\nibtimes.com\t713\ncourant.com\t712\nelespectador.com\t712\nstltoday.com\t712\nexpress.co.uk\t711\nsouthcn.com\t710\nouest-france.fr\t710\n680news.com\t709\nksl.com\t709\nsegodnya.ua\t709\nworldjournal.com\t707\nrisingbd.com\t707\ntelegraph.co.uk\t707\nafr.com\t706\nsindonews.com\t706\nhna.de\t705\nthenational.scot\t705\nmemleket.com.tr\t705\nla-croix.com\t705\nblic.rs\t705\nfrancetvinfo.fr\t704\nstern.de\t703\nrfi.fr\t702\nonlinenigeria.com\t701\nthedailystar.net\t701\ngolos.ua\t701\nletelegramme.fr\t698\nalroayah.com\t698\nperiodistadigital.com\t697\nbostonglobe.com\t697\nnst.com.my\t696\nchosun.com\t696\nindiatoday.in\t694\nilgiornale.it\t694\nriafan.ru\t694\nelsiglodedurango.com.mx\t693\neltiempo.com\t693\nnews.workercn.cn\t692\nlasprovincias.es\t691\neconotimes.com\t691\npaginasiete.bo\t691\nn-tv.de\t691\nhangzhou.com.cn\t690\ngazeta.ua\t688\neldiariodecoahuila.com.mx\t688\ncanindia.com\t688\nbssnews.net\t686\ndailytimes.com.pk\t686\npiterburger.ru\t685\nchina.com\t685\ncnn.com\t685\nlatimes.com\t684\ntribuneindia.com\t684\nnoticiasdenavarra.com\t682\ntele.at\t681\nmyjournalcourier.com\t680\nirishexaminer.com\t679\nlistindiario.com\t679\nnoticiasaominuto.com\t679\nghanaweb.com\t678\nmitbbs.com\t678\nbreitbart.com\t678\npressherald.com\t678\nt-online.de\t678\ngazette.com\t678\nfocus-news.net\t678\nregistercitizen.com\t676\nnbd.com.cn\t676\nsott.net\t676\necho.msk.ru\t675\nin.gr\t675\nelmundo.es\t673\ndelfi.lt\t673\nguardian.ng\t673\nyucatan.com.mx\t672\nmodernghana.com\t672\nsabah.com.tr\t672\ndailytrust.com.ng\t671\nmynorthwest.com\t671\nelcorreo.com\t671\ncome-on.de\t670\nscoop.co.nz\t668\nhaberturk.com\t668\nspiegel.de\t668\nfreerepublic.com\t668\ninosmi.ru\t668\nparlamentnilisty.cz\t668\nbangkokpost.com\t667\nedaily.co.kr\t667\nheraldscotland.com\t667\nfocus.de\t666\nlaraza.com\t666\nzeit.de\t664\ntagesanzeiger.ch\t661\ncna.com.tw\t661\nnews.day.az\t660\njpost.com\t660\nhaber7.com\t659\nmanilatimes.net\t657\npulsoslp.com.mx\t655\ndailyprogress.com\t655\nxiancn.com\t654\ntagesspiegel.de\t653\nnewsnowgr.com\t653\nvanguardia.com.mx\t652\nplanoinformativo.com\t652\nmysanantonio.com\t651\nrepublika.co.id\t650\nbd-pratidin.com\t650\naif.ru\t650\nmako.co.il\t649\nkp.ru\t649\nelaph.com\t649\nalbawaba.com\t649\nnewstimes.com\t648\neldiariony.com\t648\niol.co.za\t648\nvoanews.com\t647\nara.cat\t646\nchinapress.com.my\t646\nlavoz.com.ar\t645\ntoday.ng\t645\nmainpost.de\t645\nalbayan.ae\t645\ndiariocordoba.com\t645\nnewstoday.com.bd\t644\nthehill.com\t644\njornada.com.mx\t643\ndiariodesevilla.es\t642\njrj.com.cn\t642\nmcall.com\t642\nbozemandailychronicle.com\t641\nthehour.com\t641\nhoustonchronicle.com\t640\nmid-day.com\t640\nalanbatnews.net\t640\nlepoint.fr\t639\nmilliyet.com.tr\t639\ngercekgundem.com\t639\nfacenews.ua\t637\nfjsen.com\t636\nkreiszeitung.de\t636\nmissoulian.com\t636\nladepeche.fr\t635\nlapresse.ca\t635\nnaslovi.net\t635\njournalstar.com\t634\nistanbulhaber.com.tr\t634\nelperiodicoextremadura.com\t634\nthisdaylive.com\t634\nnews.milli.az\t633\nenanyang.my\t633\ndigitaljournal.com\t632\nabc.net.au\t632\nsarayanews.com\t632\nfredericksburg.com\t632\ntopontiki.gr\t632\nmzamin.com\t631\nyeniakit.com.tr\t631\nohmynews.com\t631\nmilenio.com\t630\nvnexpress.net\t630\narabnews.com\t629\ncnfol.com\t627\nhani.co.kr\t627\nusatoday.com\t626\nnw.de\t626\nukrainianwall.com\t626\nreliefweb.int\t625\npatrasevents.gr\t625\njournalgazette.net\t624\njournalducameroun.com\t624\nactionnewsjax.com\t624\nlrt.lt\t624\nasianage.com\t624\nwenweipo.com\t623\neremnews.com\t623\ngestion.pe\t622\nalbiladpress.com\t621\nwsbtv.com\t621\nadevarul.ro\t620\ninfotel.ca\t619\nkompas.com\t618\ntelegraphindia.com\t618\ntrust.org\t617\nkhaberni.com\t617\n24h.com.vn\t616\nwftv.com\t616\nkienthuc.net.vn\t616\nwral.com\t616\nyenisafak.com\t616\nstorm.mg\t615\nlastampa.it\t615\ntherepublic.com\t615\npantip.com\t614\nseoul.co.kr\t614\nzerohedge.com\t613\n24heures.ch\t613\ndiariodecadiz.es\t612\nsiouxcityjournal.com\t611\nlaverdad.es\t611\ncairnspost.com.au\t611\nlife.ru\t610\njournaldebrazza.com\t609\nmessenger-inquirer.com\t609\nnypost.com\t609\nhurriyet.com.tr\t609\ntanea.gr\t609\nellitoral.com.ar\t609\nhuelvainformacion.es\t609\nbadische-zeitung.de\t608\nrawstory.com\t608\nmk.ru\t607\n5-tv.ru\t607\nlasillarota.com\t607\nalwasat.ly\t606\nnydailynews.com\t606\nfoxnews.com\t605\njagran.com\t605\nlaestrella.com.pa\t605\nelcomercio.com\t605\nhespress.com\t605\neveningexpress.co.uk\t604\ninformador.mx\t604\nrga.de\t604\naljarida.com\t603\nrecord-eagle.com\t603\nilmessaggero.it\t602\nstaradvertiser.com\t602\njstv.com\t602\nhsbnoticias.com\t602\naljazeera.com\t601\njournaldebangui.com\t600\nhebei.com.cn\t600\nbulawayo24.com\t600\nmadison.com\t599\nlapatriaenlinea.com\t599\nsurreycomet.co.uk\t598\ncapital.gr\t598\n15min.lt\t597\nvoc.com.cn\t595\nzocalo.com.mx\t595\nmalatyaguncel.com\t595\nreadingeagle.com\t594\nheraldo.es\t594\ndantri.com.vn\t594\nilmattino.it\t593\npublico.es\t593\nnews.com.au\t593\naydinses.com\t593\n570news.com\t593\ntheargus.co.uk\t592\nokezone.com\t592\ntovima.gr\t592\nindiatvnews.com\t591\nnikkei.com\t590\nce.cn\t590\nsozcu.com.tr\t589\ndothaneagle.com\t589\ntdg.ch\t589\namarujala.com\t589\nwatoday.com.au\t588\neuropapress.es\t588\nthecourier.co.uk\t588\nreal.gr\t588\npusulahaber.com.tr\t587\ncouriermail.com.au\t587\nexpressnews.com\t587\napnews.com\t587\ngulftoday.ae\t586\nindia.com\t586\nbakersfield.com\t586\nacento.com.do\t586\ndiariodejerez.es\t585\nsanjeevnitoday.com\t585\neastday.com\t585\nprotothema.gr\t585\ncorreiobraziliense.com.br\t584\nwtop.com\t583\nrepublicworld.com\t583\nalrai.com\t582\n1310news.com\t582\nbemparana.com.br\t581\npremiumtimesng.com\t581\njutarnji.hr\t580\nathensvoice.gr\t580\ngreenwichtime.com\t580\nelperiodico.com\t580\nhankookilbo.com\t579\nthesun.co.uk\t579\nbelfasttelegraph.co.uk\t579\ndeia.eus\t579\neurozpravy.cz\t578\nura.news\t577\nrnz.co.nz\t577\nfox23.com\t577\nkvia.com\t577\nethnos.gr\t577\nbillingsgazette.com\t576\nfaz.net\t576\nsotaliraq.com\t575\nwalla.co.il\t575\ninquisitr.com\t575\nmadata.gr\t575\ndgabc.com.br\t575\nredressonline.com\t574\nheraldcourier.com\t574\njournaldemontreal.com\t574\nlacapital.com.ar\t573\nwpxi.com\t573\naccesswdun.com\t572\nbursadabugun.com\t572\nnews24.com\t572\nelobservador.com.uy\t571\nindex.hr\t570\nvz.ru\t568\naz-online.de\t568\nseekingalpha.com\t568\nkmib.co.kr\t568\nmorgenpost.de\t568\ncnnb.com.cn\t567\ntulsaworld.com\t567\nelnuevodia.com\t567\nabendblatt.de\t566\nlarioja.com\t566\nmt.co.kr\t566\nlacrossetribune.com\t566\npulse.ng\t565\nfrom-ua.com\t565\nalghad.com\t565\nr7.com\t565\ntimesunion.com\t564\nnews247.gr\t564\nmoz.de\t563\nhandelsblatt.com\t563\nelperiodicodearagon.com\t563\nnacion.com\t563\nclactonandfrintongazette.co.uk\t562\nthestandard.co.zw\t562\npnn.ps\t562\nelmanana.com\t562\nnwitimes.com\t562\nig.com.br\t561\nhaaretz.com\t561\npantagraph.com\t561\npresstv.com\t561\nkiro7.com\t561\nabqjournal.com\t561\nhn.rednet.cn\t561\nthanhnien.vn\t560\ndailyjournal.net\t560\nyourlocalguardian.co.uk\t560\nnews1.kr\t560\nhaberflash.com\t560\njournaldutchad.com\t559\nstuttgarter-zeitung.de\t558\ndailypress.com\t558\nrappler.com\t557\nultimahora.com\t557\nkrstarica.com\t557\ntrud.bg\t557\ndanviet.vn\t557\nsolinger-tageblatt.de\t556\nsofokleous10.gr\t556\nwcfcourier.com\t556\nbgdailynews.com\t556\nlenta.ru\t556\ncolumbian.com\t555\nnv.ua\t555\nnewspim.com\t554\nq107.com\t554\nvol.at\t554\nqctimes.com\t553\nepochtimes.de\t552\netoday.co.kr\t550\nnewsadvance.com\t550\neldiadecordoba.es\t550\nazcentral.com\t550\nbeaumontenterprise.com\t549\nstripes.com\t549\nfox13memphis.com\t548\niltirreno.gelocal.it\t547\nkavkaz-uzel.eu\t547\nannaharkw.com\t546\njang.com.pk\t546\ntheconversation.com\t545\ngunes.com\t545\ndn.se\t544\ndayoo.com\t544\nnzz.ch\t544\nt24.com.tr\t543\nsabq.org\t543\nprabhatkhabar.com\t543\nomaha.com\t543\neju.tv\t542\nmemurlar.net\t542\npressorg24.com\t542\niha.com.tr\t542\nlaprovence.com\t542\nroanoke.com\t541\nlivehindustan.com\t540\nlainformacion.com\t540\nswissinfo.ch\t540\ntienphong.vn\t540\npetra.gov.jo\t539\ncorsematin.com\t539\nlagaceta.com.ar\t539\nbreakingnews.ie\t539\nelpasoinc.com\t538\nblitz.bg\t538\nktar.com\t538\nmmstd.com\t538\nantena3.com\t538\nksat.com\t537\nthairath.co.th\t537\nelmoudjahid.com\t537\nsantafenewmexican.com\t537\nmonitor.co.ug\t537\ntelemetro.com\t537\nnorthwestgeorgianews.com\t537\nvoiceofalexandria.com\t536\nhoydiariodelmagdalena.com.co\t536\nunionleader.com\t536\n24hod.sk\t535\nnews957.com\t535\nlefigaro.fr\t535\nrbc.ru\t535\nbisnis.com\t535\ntimedg.com\t534\nhaaretz.co.il\t534\ntsn.ua\t534\nistoe.com.br\t534\nren.tv\t534\nthisislocallondon.co.uk\t534\nwiadomosci.onet.pl\t533\nycwb.com\t533\ngreensboro.com\t533\nsakshi.com\t533\nheraldbulletin.com\t533\neldiario.es\t532\nelpais.cr\t532\nvecernji.hr\t532\ntaz.de\t532\njschina.com.cn\t531\ncafef.vn\t530\nabc.com.py\t530\nsomersetcountygazette.co.uk\t529\nklaipeda.diena.lt\t529\nkorrespondent.net\t529\ntheday.com\t529\nsalon.com\t529\nalbanyherald.com\t529\ntaipeitimes.com\t529\ncfi.net.cn\t529\nkauno.diena.lt\t528\nsciencedaily.com\t528\nlemonde.fr\t528\ntelegraf.com.ua\t527\nthegardenisland.com\t527\nelcorreogallego.es\t527\njournaldequebec.com\t527\nipreunion.com\t526\nbournemouthecho.co.uk\t526\nmittelbayerische.de\t526\ntz.de\t526\ninforum.com\t526\nkamuajans.com\t526\npressandjournal.co.uk\t526\ngazettextra.com\t525\ngxnews.com.cn\t525\nfarodevigo.es\t525\nbeyazgazete.com\t525\nwa.de\t525\nkoreatimes.co.kr\t525\nnairaland.com\t524\nnouvelobs.com\t524\nleaderlive.co.uk\t524\nis.fi\t524\nelpais.com.co\t524\nlesechos.fr\t523\nvtc.vn\t523\nbigmir.net\t523\nntdtv.com\t523\nnewbusinessethiopia.com\t523\nalomanaa.net\t522\neldia.com.do\t522\nludlowadvertiser.co.uk\t522\ndailystar.co.uk\t522\nhs.fi\t522\nwinsfordguardian.co.uk\t522\nrisalehaber.com\t522\neasternontarionetwork.com\t522\ntrib.com\t522\naporrea.org\t521\ntimesofmalta.com\t521\naawsat.com\t521\nilfattoquotidiano.it\t521\nnonpareilonline.com\t521\nlexpress.fr\t520\neuropasur.es\t520\nkaramapress.com\t520\ngranadahoy.com\t520\navgi.gr\t520\ntrend.az\t520\nrueconomics.ru\t520\nkhaleejtimes.com\t519\nelnortedecastilla.es\t519\npatch.com\t519\nchannelnewsasia.com\t519\nkoamnewsnow.com\t519\necho-news.co.uk\t518\nlifo.gr\t518\nmichigansthumb.com\t518\nbt.se\t518\nazdailysun.com\t518\nbusan.com\t517\nnews.dahe.cn\t517\nbaophapluat.vn\t517\nsigmalive.com\t517\nvov.vn\t516\ndiariocorreo.pe\t516\nsbs.com.au\t515\n20minutes.fr\t515\nanandabazar.com\t514\nnwemail.co.uk\t514\nnewsru.co.il\t514\nbaltimoresun.com\t514\nbasildonstandard.co.uk\t513\nrts.rs\t513\nmonthlyreview.org\t513\n24-horas.mx\t513\nhirado.hu\t513\niefimerida.gr\t512\ngiaoducthoidai.vn\t512\ndailysabah.com\t512\nguernseypress.com\t511\ndiena.lt\t511\ntexarkanagazette.com\t511\nkxly.com\t511\ndailypost.ng\t511\nthehindubusinessline.com\t510\nvaldostadailytimes.com\t510\nakhbar-alkhaleej.com\t510\nedmontonsun.com\t510\nterra.com.br\t509\nhumanite.fr\t509\nlaregion.es\t508\nktvz.com\t508\nalquds.com\t508\nnr2.com.ua\t508\nwandsworthguardian.co.uk\t508\ncanada.com\t507\nidnes.cz\t507\nwlz-online.de\t507\nnovinky.cz\t507\norigo.hu\t507\ngiadinh.net.vn\t507\ngordonua.com\t507\ntimescolonist.com\t507\noxfordmail.co.uk\t507\n19rus.info\t506\nkwongwah.com.my\t506\nglobes.co.il\t505\nthesundaily.my\t505\nbangkokbiznews.com\t505\nswindonadvertiser.co.uk\t505\nperiodicocorreo.com.mx\t505\nng.ru\t505\ndanas.rs\t505\nglavred.info\t505\ndiariodeburgos.es\t505\ndonga.com\t504\nsn.dk\t504\nthewestmorlandgazette.co.uk\t504\nkarriere.at\t503\nnewsandstar.co.uk\t503\nnewsbomb.gr\t502\npolitika.rs\t502\nnewsradio1440.com\t501\ncnnturk.com\t501\nkkoh.com\t501\ntribtown.com\t501\nsydostran.se\t501\ntvzvezda.ru\t501\nimpartialreporter.com\t501\nlexpress.mu\t501\nmalaymail.com\t501\niheart.com\t500\nnur.kz\t500\nwfmz.com\t500\nlostiempos.com\t500\nnetscape.com\t500\nilgazzettino.it\t500\neldiarionuevodia.com.ar\t499\nblick.ch\t499\ncumhuriyet.com.tr\t498\n24sata.hr\t498\nmessengernewspapers.co.uk\t498\npoststar.com\t498\ntimesandstar.co.uk\t498\nthejournal.ie\t497\nnewsit.gr\t497\nrp-online.de\t497\nwbap.com\t497\nnews12.com\t497\nistoedinheiro.com.br\t496\nkyma.com\t496\nallkharkov.ua\t496\nlmtribune.com\t496\neveningtimes.co.uk\t496\naguasdigital.com\t496\nwgow.com\t496\nmoneycontrol.com\t495\nnate.com\t495\nsofokleousin.gr\t494\nblesk.cz\t494\npnp.de\t494\ntime.mk\t494\neleftherostypos.gr\t493\ninquirer.com\t493\ndailyexaminer.com.au\t493\nglobaltimes.cn\t493\nturkiyegazetesi.com.tr\t492\nlanacion.com.ar\t492\npravda.com.ua\t492\nelexpres.com\t492\nharwichandmanningtreestandard.co.uk\t492\nheraldcorp.com\t492\ntheintelligencer.com\t492\nheraldsun.com.au\t492\ndailyecho.co.uk\t491\nberliner-zeitung.de\t491\nworcesternews.co.uk\t490\narabweek.com.lb\t490\njapantoday.com\t490\naktiv.origo.hu\t490\nvindy.com\t490\nunian.net\t490\n9news.com.au\t490\ndainikamadershomoy.com\t490\nctvnews.ca\t489\ncronica.com.ar\t489\naftonbladet.se\t489\nemaratalyoum.com\t489\nvm.ru\t489\nbhaskar.com\t489\nmagicvalley.com\t489\nnews.zing.vn\t488\namericanthinker.com\t488\ntdn.com\t488\ndjournal.com\t488\nsondakika.com\t487\nconfirmado.com.ve\t487\nrundschau-online.de\t487\nblt.se\t487\nalarab.co.uk\t487\nbb.lv\t487\nwacotrib.com\t487\neldiadevalladolid.com\t487\nukrinform.ua\t487\njournaltimes.com\t487\nkrdo.com\t487\ndailyherald.com\t487\nlarena.it\t486\nrri.co.id\t486\nthisiswiltshire.co.uk\t486\nmanilastandard.net\t486\ncnnindonesia.com\t486\nnotimerica.com\t486\nvolksstimme.de\t486\nkeighleynews.co.uk\t486\ntvn-2.com\t486\nstcn.com\t486\nversionfinal.com.ve\t485\nhumanitariannews.org\t485\nwimbledonguardian.co.uk\t485\nobservatoriodaimprensa.com.br\t485\nelnacional.com.do\t485\nthechronicle.com.au\t485\nmuscatinejournal.com\t485\nexpressen.se\t485\npanamaamerica.com.pa\t484\nici.radio-canada.ca\t484\ndogruhaber.com.tr\t484\nal-seyassah.com\t484\notempo.com.br\t484\nwsau.com\t484\nrnd.de\t484\nnaftemporiki.gr\t483\nvoria.gr\t483\narthosuchak.com\t483\nfreiepresse.de\t483\n5minutes.rtl.lu\t483\ntrthaber.com\t483\ndelcotimes.com\t482\n24ur.com\t482\norientaldaily.com.my\t482\nstourbridgenews.co.uk\t481\nphilenews.com\t481\ndiariodecuyo.com.ar\t481\nwiltshiretimes.co.uk\t480\noaoa.com\t480\nbrownsvilleherald.com\t480\nshm.com.cn\t480\nshabiba.com\t479\nproceso.com.mx\t479\nntnews.com.au\t479\nbild.de\t478\nborehamwoodtimes.co.uk\t478\nelcaribe.com.do\t478\nvecer.com\t478\naleqt.com\t478\nglobedia.com\t478\nexpress.pk\t477\nnewsday.com\t477\npunjabkesari.com\t477\ngodanriver.com\t477\nobservador.pt\t477\nettvamerica.com\t477\ntheboltonnews.co.uk\t477\nsoester-anzeiger.de\t477\neveningtelegraph.co.uk\t477\npalpalindia.com\t476\nasahi.com\t476\npulsopolitico.com.mx\t476\njournalnow.com\t476\nvozpopuli.com\t476\nhabervitrini.com\t475\nlamontagne.fr\t475\nbfm.ru\t475\nbraintreeandwithamtimes.co.uk\t475\nthenorthernecho.co.uk\t475\ntn.com.ar\t474\ndiariodealmeria.es\t474\nbiobiochile.cl\t474\ndn.pt\t474\nsmp.se\t474\nafamily.vn\t474\nekuriren.se\t474\ness.fi\t473\nlancashiretelegraph.co.uk\t473\nwalesonline.co.uk\t473\npravda.ru\t473\npeiner-nachrichten.de\t473\ncountypress.co.uk\t473\nansa.it\t473\nthetelegraphandargus.co.uk\t473\nsunshinecoastdaily.com.au\t472\nhvg.hu\t472\nthueringer-allgemeine.de\t472\nnewtalk.tw\t472\nqt.com.au\t472\nbucksfreepress.co.uk\t472\notz.de\t471\nskai.gr\t471\nfao.org\t471\nelexpresso.com\t471\ntintuc.vn\t471\nmankatofreepress.com\t470\nslobodnadalmacija.hr\t470\nlavozdeasturias.es\t469\nlocalnews8.com\t469\nsalisburyjournal.co.uk\t469\nlaprensa.hn\t469\ninvesting.com\t469\nwnmtradio.com\t468\nirvinetimes.com\t468\ngladstoneobserver.com.au\t468\nnews.ngs.ru\t468\nnj.com\t468\nyle.fi\t468\nworld.workercn.cn\t468\ngazetteandherald.co.uk\t468\nbjnews.com.cn\t468\nrtvslo.si\t467\nnapavalleyregister.com\t467\nptinews.com\t467\n81.cn\t467\nprajavani.net\t467\nnagariknetwork.com\t466\nagencianova.com\t466\nkmaj1440.com\t466\nevrensel.net\t466\nkenh14.vn\t466\nbismarcktribune.com\t465\nchesterstandard.co.uk\t465\nwsls.com\t465\nnewstracklive.com\t465\nfinanzen.net\t465\njerseyeveningpost.com\t465\nglavnoe.ua\t465\ninsurancenewsnet.com\t465\nhljnews.cn\t465\nsn.se\t465\ntheprovince.com\t465\nrpp.pe\t465\nperiodicocentral.mx\t464\ntheindependent.com\t464\noeeee.com\t464\nlematin.ch\t464\nsalzgitter-zeitung.de\t464\nnovini.bg\t464\nnld.com.vn\t464\ncalcalist.co.il\t463\ncyprus-mail.com\t463\njournaldumali.com\t463\nscotsman.com\t463\nbadenertagblatt.ch\t463\noleantimesherald.com\t462\nfreepressseries.co.uk\t462\n"},{"data":"<div class=\"result-alert alert-warning\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button><strong>Output is truncated</strong> to 1000 rows. Learn more about <strong>zeppelin.spark.maxResult</strong></div>\n","type":"HTML"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1579854914688_1386863527","id":"20200123-210810_443671581","dateCreated":"2020-01-24T08:35:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:250","dateFinished":"2020-01-24T08:42:15+0000","dateStarted":"2020-01-24T08:42:07+0000"},{"text":"// Display theme distribution for yahoo.com\nz.show(query3_article_by_theme.\nfilter($\"source_common_name\" === \"yahoo.com\")\n.select(\"theme\",\"num_article\")\n.groupBy(\"theme\")\n.agg(sum(\"num_article\").alias(\"number of articles\"))\n.orderBy(desc(\"number of articles\")).limit(10))","user":"anonymous","dateUpdated":"2020-01-24T08:42:15+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"theme":"string","number of articles":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"theme\tnumber of articles\nTAX_FNCACT\t1117\nTAX_ETHNICITY\t550\nEPU_POLICY\t534\nUNGP_FORESTS_RIVERS_OCEANS\t487\nCRISISLEX_CRISISLEXREC\t472\nTAX_WORLDLANGUAGES\t452\nEPU_ECONOMY_HISTORIC\t417\nUSPEC_POLITICS_GENERAL1\t333\nLEADER\t328\nGENERAL_GOVERNMENT\t321\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1579854914690_1513356810","id":"20200123-205932_648623452","dateCreated":"2020-01-24T08:35:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:251","dateFinished":"2020-01-24T08:42:17+0000","dateStarted":"2020-01-24T08:42:15+0000"},{"text":"// Display tone of theme  for yahoo.com\nz.show(query3_article_by_person.filter($\"day\" !== 1))","user":"anonymous","dateUpdated":"2020-01-24T09:16:01+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"source_common_name":"string","year":"string","month":"string","day":"string","person":"string","num_article":"string","sum_tone":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"source_common_name":"string","year":"string","month":"string","day":"string","person":"string","num_article":"string","sum_tone":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n"},{"type":"TABLE","data":"source_common_name\tyear\tmonth\tday\tperson\tnum_article\tsum_tone\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1579854914692_522381203","id":"20200123-210714_1168310995","dateCreated":"2020-01-24T08:35:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:252","dateFinished":"2020-01-24T09:15:59+0000","dateStarted":"2020-01-24T09:15:40+0000"},{"text":"z.show(query3_article_by_person.select(\"day\", \"num_article\").groupBy(\"day\").agg(sum(\"num_article\")))","user":"anonymous","dateUpdated":"2020-01-24T08:42:18+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"day":"string","sum(num_article)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"day\tsum(num_article)\n1\t711164\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1579854914695_1582718970","id":"20200123-214951_318251070","dateCreated":"2020-01-24T08:35:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:253","dateFinished":"2020-01-24T08:42:21+0000","dateStarted":"2020-01-24T08:42:18+0000"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"person":"string","sum_tone":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579858338800_-153510030","id":"20200124-093218_986228174","dateCreated":"2020-01-24T09:32:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:17689","text":"z.show(query3_article_by_person\n.select(\"person\",\"sum_tone\")\n.orderBy(desc(\"sum_tone\"))\n.limit(10)\n    )","dateUpdated":"2020-01-24T09:32:36+0000","dateFinished":"2020-01-24T09:32:35+0000","dateStarted":"2020-01-24T09:32:33+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"person\tsum_tone\nluna simone stephens\t2379\ntheodore stephens\t2379\njohn legend\t2379\nchrissy teigen\t1906\npeter bruun\t767\nkevin domas\t701\nmeshkov brest\t581\nrodney cleveland\t526\nmelissa crenshaw\t526\namy fennell\t526\n"},{"type":"TEXT","data":""}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"person":"string","sum_tone":"string","num_article":"string","ave_tone":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579858015057_-2002921973","id":"20200124-092655_2094875021","dateCreated":"2020-01-24T09:26:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:16011","text":"z.show(query3_article_by_person\n.filter($\"num_article\" > 10)\n.select(\"person\",\"sum_tone\", \"num_article\")\n.withColumn(\"ave_tone\", $\"sum_tone\"/$\"num_article\")\n.orderBy(desc(\"ave_tone\"))\n.limit(10)\n    )","dateUpdated":"2020-01-24T09:35:02+0000","dateFinished":"2020-01-24T09:35:04+0000","dateStarted":"2020-01-24T09:35:02+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"person\tsum_tone\tnum_article\tave_tone\nluna simone stephens\t2379\t149\t15.966442953020135\ntheodore stephens\t2379\t149\t15.966442953020135\njohn legend\t2379\t149\t15.966442953020135\nchuck wicks\t320\t30\t10.666666666666666\nmiroslav adamek\t179\t20\t8.95\nlee ma yan\t143\t16\t8.9375\nyi king\t143\t16\t8.9375\nzhao li ying\t143\t16\t8.9375\npearl king\t143\t16\t8.9375\nzlatko zlatanov\t102\t12\t8.5\n"},{"type":"TEXT","data":""}]}},{"text":"// Most tone for donald trump for source msn.com\nz.show(query3_article_by_person.\nfilter($\"source_common_name\" === \"theguardian.com\" || $\"source_common_name\" === \"indiatimes.com \" || $\"source_common_name\" === \"sputniknews.com\" || $\"source_common_name\" === \"nytimes.com\")\n.filter($\"person\" === \"donal trump\")\n.select(\"source_common_name\",\"sum_tone\")\n.groupBy(\"source_common_name\")\n.agg(sum(\"sum_tone\").alias(\"tone of articles\"))\n.orderBy(desc(\"tone of articles\")).limit(10))","user":"anonymous","dateUpdated":"2020-01-24T09:29:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"source_common_name":"string","tone of articles":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"source_common_name","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"tone of articles","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"source_common_name\ttone of articles\nnytimes.com\t-1\ntheguardian.com\t-3\nsputniknews.com\t-6\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1579854914696_621916098","id":"20200123-213722_1662473007","dateCreated":"2020-01-24T08:35:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:254","dateFinished":"2020-01-24T09:26:35+0000","dateStarted":"2020-01-24T09:26:14+0000"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"source_common_name":"string","tone of articles":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"source_common_name","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"tone of articles","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579858117112_1968217481","id":"20200124-092837_1042494235","dateCreated":"2020-01-24T09:28:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:16733","text":"// Most tone for donald trump for source msn.com\nz.show(query3_article_by_person\n.filter($\"person\" === \"john legend\")\n.select(\"source_common_name\",\"sum_tone\")\n.groupBy(\"source_common_name\")\n.agg(sum(\"sum_tone\").alias(\"tone of articles\"))\n.orderBy(desc(\"tone of articles\")).limit(10))","dateUpdated":"2020-01-24T09:35:41+0000","dateFinished":"2020-01-24T09:35:37+0000","dateStarted":"2020-01-24T09:35:34+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"source_common_name\ttone of articles\niheart.com\t2379\nsheknows.com\t19\njustjared.com\t15\nashleycountyledger.com\t14\nnews-expressky.com\t14\nnorthwestgeorgianews.com\t14\nwkuherald.com\t14\ndailystarjournal.com\t14\nparsonssun.com\t14\nmsn.com\t14\n"},{"type":"TEXT","data":""}]}},{"text":"// ***************** Query 4 ******************","user":"anonymous","dateUpdated":"2020-01-24T08:42:24+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579854914696_-293932897","id":"20200123-220133_402925733","dateCreated":"2020-01-24T08:35:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:255","dateFinished":"2020-01-24T08:42:24+0000","dateStarted":"2020-01-24T08:42:24+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"val query4 = spark.read\n      .cassandraFormat(\"country_map\", \"gdelt\")\n      .load()","user":"anonymous","dateUpdated":"2020-01-24T08:42:25+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"query4: org.apache.spark.sql.DataFrame = [translation_info: string, country_code: string ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1579854914696_-991613377","id":"20200123-220623_253962536","dateCreated":"2020-01-24T08:35:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:256","dateFinished":"2020-01-24T08:42:25+0000","dateStarted":"2020-01-24T08:42:25+0000"},{"text":"z.show(query4\n.select(\"country_code\",\"month\", \"sum_tone\", \"num_article\")\n.groupBy(\"month\")\n.agg(sum(\"sum_tone\").alias(\"sum_sum_tone\"),sum(\"num_article\").alias(\"sum_article\"))\n.withColumn(\"ave_tone\", $\"sum_sum_tone\"/$\"sum_article\")\n.orderBy(desc(\"ave_tone\"))\n.limit(20))","user":"anonymous","dateUpdated":"2020-01-24T09:47:44+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"month":"string","sum_sum_tone":"string","sum_article":"string","ave_tone":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"month\tsum_sum_tone\tsum_article\tave_tone\n2\t-2.8595508E7\t17722490\t-1.6135152566033328\n4\t-3.0004591E7\t17328432\t-1.7315237177835825\n6\t-2.981731E7\t16917922\t-1.7624688185700348\n5\t-3.1146301E7\t17442450\t-1.785660901994846\n1\t-3.4007879E7\t18785678\t-1.8103088427258256\n9\t-2.9986197E7\t16426620\t-1.8254636072423907\n7\t-3.1507976E7\t17070292\t-1.8457783850446143\n12\t-2.7219608E7\t14704096\t-1.8511582078898288\n3\t-3.5050967E7\t18497194\t-1.8949342803021907\n10\t-3.4612439E7\t18052100\t-1.9173635754288976\n11\t-2.9576875E7\t15318912\t-1.930742535762331\n8\t-3.5546965E7\t16448950\t-2.1610476656564703\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1579854914696_2003429521","id":"20200123-220712_203785754","dateCreated":"2020-01-24T08:35:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:257","dateFinished":"2020-01-24T09:47:40+0000","dateStarted":"2020-01-24T09:47:19+0000"},{"text":"// compare two countries in tones for months\nz.show(query4\n.filter($\"country_code\" === \"US\" || $\"country_code\" === \"UK\")\n.select(\"country_code\",\"sum_tone\",\"month\")\n.groupBy(\"country_code\",\"month\")\n.agg(sum(\"sum_tone\").alias(\"tone\")).orderBy(asc(\"month\")))","user":"anonymous","dateUpdated":"2020-01-24T08:42:26+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"country_code":"string","month":"string","tone":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"month","index":1,"aggr":"sum"}],"groups":[{"name":"country_code","index":0,"aggr":"sum"}],"values":[{"name":"tone","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"country_code\tmonth\ttone\nUK\t1\t-772891.0\nUS\t1\t-3092434.0\nUS\t2\t-2418289.0\nUK\t2\t-488765.0\nUK\t3\t-905656.0\nUS\t3\t-2783432.0\nUS\t4\t-2884997.0\nUK\t4\t-1493252.0\nUK\t5\t-861578.0\nUS\t5\t-3394915.0\nUS\t6\t-3118245.0\nUK\t6\t-685682.0\nUS\t7\t-3327878.0\nUK\t7\t-849090.0\nUS\t8\t-4455069.0\nUK\t8\t-837135.0\nUS\t9\t-3209541.0\nUK\t9\t-1280325.0\nUS\t10\t-3303784.0\nUK\t10\t-873792.0\nUS\t11\t-2582552.0\nUK\t11\t-967771.0\nUK\t12\t-571983.0\nUS\t12\t-2969918.0\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1579854914700_-1360890839","id":"20200123-221420_1668856494","dateCreated":"2020-01-24T08:35:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:258","dateFinished":"2020-01-24T08:42:30+0000","dateStarted":"2020-01-24T08:42:26+0000"},{"user":"anonymous","dateUpdated":"2020-01-24T09:39:21+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579854914700_1996914692","id":"20200123-221854_909861793","dateCreated":"2020-01-24T08:35:14+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:259","text":"// compare two countries in tones for months\nz.show(query4\n.filter($\"country_code\" === \"US\" || $\"country_code\" === \"UK\")\n.select(\"country_code\",\"sum_tone\",\"month\")\n.groupBy(\"country_code\",\"month\")\n.agg(sum(\"sum_tone\").alias(\"tone\")).orderBy(asc(\"month\")))"}],"name":"gdeltFinal","id":"2EY6MUWUK","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}