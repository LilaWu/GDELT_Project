{"paragraphs":[{"text":"import org.apache.spark.{SparkConf, SparkContext}\nimport org.apache.spark.sql.{DataFrame, SparkSession, SaveMode}\nimport org.apache.spark.input.PortableDataStream\nimport org.apache.spark.sql.functions._\nimport java.util.zip.ZipInputStream\nimport java.io.BufferedReader\nimport java.io.InputStreamReader\nimport com.datastax.spark.connector.cql.CassandraConnector\nimport org.apache.spark.sql.cassandra._\n\nimport org.apache.spark.rdd.RDD\n\nimport spark.implicits._\nval AWS_ID = \"ASIAX7FDIQZH4WTZWXLX\"\nval AWS_KEY = \"1MQguTIXmpjPwR50oBt/ie2ZKs6fQARXgXhg3rFe\"\nval AWS_TOKEN = \"FwoGZXIvYXdzEMP//////////wEaDJ/T1gzVZU5wc8qPFSK/ATjyehB96tohsGbLCXXVG+lpS39Zd4Dy6/na5oy7x/y1LuhiPydWtlV+wX3fsMoLIBIHczE9eVovnJLlbbQQ1qtjJ7d8QbMAcXIUAGeWy1zdyObAj3Zd0eDs/rmyz3z7b0pV+nSnUyXhSP+Bq1kEvPYE0DVmUPsLRBmpZTU5Bge4ycWF509rV2atVFMWmTvgQF6/4KtFnhnLKv4goKYUszoBsHZtIf8hxll5Npds6U/ufbVJlDgWZDmylUp4nxuoKLK5p/EFMi3AnnoKMeP9aFyVIloYfJT6WnF8m+E2fxAxtUlitGMSGQ3e4jXyAcsSwXSVvLM=\"\nval s3_name = \"projet-gdelt-2019\"\n\nsc.hadoopConfiguration.set(\"fs.s3a.aws.credentials.provider\", \"org.apache.hadoop.fs.s3a.TemporaryAWSCredentialsProvider\")\nsc.hadoopConfiguration.set(\"fs.s3a.access.key\", AWS_ID)\nsc.hadoopConfiguration.set(\"fs.s3a.secret.key\", AWS_KEY)\nsc.hadoopConfiguration.set(\"fs.s3a.session.token\", AWS_TOKEN)","user":"anonymous","dateUpdated":"2020-01-23T19:20:06+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.{SparkConf, SparkContext}\nimport org.apache.spark.sql.{DataFrame, SparkSession, SaveMode}\nimport org.apache.spark.input.PortableDataStream\nimport org.apache.spark.sql.functions._\nimport java.util.zip.ZipInputStream\nimport java.io.BufferedReader\nimport java.io.InputStreamReader\nimport com.datastax.spark.connector.cql.CassandraConnector\nimport org.apache.spark.sql.cassandra._\nimport org.apache.spark.rdd.RDD\nimport spark.implicits._\nAWS_ID: String = ASIAX7FDIQZH4WTZWXLX\nAWS_KEY: String = 1MQguTIXmpjPwR50oBt/ie2ZKs6fQARXgXhg3rFe\nAWS_TOKEN: String = FwoGZXIvYXdzEMP//////////wEaDJ/T1gzVZU5wc8qPFSK/ATjyehB96tohsGbLCXXVG+lpS39Zd4Dy6/na5oy7x/y1LuhiPydWtlV+wX3fsMoLIBIHczE9eVovnJLlbbQQ1qtjJ7d8QbMAcXIUAGeWy1zdyObAj3Zd0eDs/rmyz3z7b0pV+nSnUyXhSP+Bq1kEvPYE0DVmUPsLRBmpZTU5Bge4yc..."}]},"apps":[],"jobName":"paragraph_1579805014604_-1994182603","id":"20200123-085417_320799483","dateCreated":"2020-01-23T18:43:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:259","dateFinished":"2020-01-23T19:20:08+0000","dateStarted":"2020-01-23T19:20:06+0000"},{"text":"// ********************* QUERY 1 *********************","user":"anonymous","dateUpdated":"2020-01-23T19:20:08+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579805014605_-1814487743","id":"20200123-101154_1340086794","dateCreated":"2020-01-23T18:43:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:260","dateFinished":"2020-01-23T19:20:09+0000","dateStarted":"2020-01-23T19:20:08+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"val query1 = spark.read\n      .cassandraFormat(\"event_by_day\", \"gdelt\")\n      .load()","user":"anonymous","dateUpdated":"2020-01-23T19:58:04+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"query1: org.apache.spark.sql.DataFrame = [date: string, country: string ... 2 more fields]\n"}]},"apps":[],"jobName":"paragraph_1579805014606_2036523290","id":"20200123-094703_329133696","dateCreated":"2020-01-23T18:43:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:264","dateFinished":"2020-01-23T19:58:05+0000","dateStarted":"2020-01-23T19:58:04+0000"},{"text":"// Display number of events by country\nz.show(query1.select(\"country\",\"count_events\").groupBy(\"country\").agg(sum(\"count_events\")))","user":"anonymous","dateUpdated":"2020-01-23T19:58:09+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"pieChart","height":759.967,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"country":"string","sum(count_events)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"pieChart":{}},"commonSetting":{},"keys":[{"name":"country","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"sum(count_events)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"country\tsum(count_events)\nLT\t1925\nCI\t68397\nPC\t13\nFI\t66610\nIC\t7470\nPM\t88097\nSC\t253\nPU\t1539\nNS\t3236\nRO\t298808\nSL\t4118\nLA\t5209\nNL\t109316\nSB\t4\nMN\t4118\nAM\t68428\nPL\t245794\nPS\t2035\nRE\t3276\nUV\t61758\nMK\t209671\nAA\t458\nAY\t2856\nDR\t5544\nMX\t632736\nPF\t314\nYI\t1358\nGL\t3405\nTV\t117\nBP\t796\nSM\t407\nCN\t1000\nFG\t214\nTI\t5282\nSW\t203617\nAV\t519\nBU\t105163\nCG\t31637\nNT\t5\nLI\t5951\nHR\t76430\nSV\t241\nNP\t29990\nWE\t101719\nBX\t4701\nTU\t642620\nSO\t54119\nVQ\t793\nGG\t15929\nPG\t135\nRI\t89628\nRQ\t23912\nBC\t2620\nGH\t50798\nBN\t3915\nCV\t1645\nHK\t15784\nNH\t2610\nMI\t8062\nTW\t39838\nGV\t10690\nSU\t90755\nBD\t2672\nWI\t1153\nTO\t12373\nLY\t69888\nID\t343780\nFK\t11\nIV\t21615\nTP\t381\nAU\t60408\nPK\t214408\nSA\t252247\nGZ\t27873\nBL\t56703\nBM\t18203\nCA\t611062\nCT\t9423\nNE\t467\nUZ\t9794\nGB\t21102\nMT\t30391\nBR\t539114\nKZ\t26628\nHO\t44298\nBY\t8525\nNC\t390\nVT\t7337\nEN\t16173\nGK\t2615\nGT\t43603\nMD\t34997\nRB\t70953\nIO\t31\nGJ\t2516\nSP\t390521\nEC\t30575\nIR\t352315\nMO\t64073\nES\t20788\nNR\t493\nBH\t4136\nVI\t469\nPO\t101465\nMR\t8340\nVE\t704881\nMB\t1690\nOD\t7936\nZA\t9895\nJN\t5\nSF\t100688\nKR\t254\nWQ\t9\nTZ\t10349\nWA\t6214\nRS\t1295657\nUS\t7314414\nAQ\t408\nLH\t49536\nTS\t43409\nEK\t1911\nAL\t66527\nMY\t46454\nIN\t542518\nJM\t18087\nGM\t506910\nBK\t9698\nAE\t71351\nKV\t24138\nCM\t18629\nRW\t15269\nMJ\t7224\nFR\t655243\nAJ\t49671\nDA\t83711\nCH\t839738\nMG\t7502\nTN\t1527\nGQ\t3134\nNU\t34463\nZI\t72863\nKT\t142\nTL\t117\nWF\t8\nGR\t408597\nUP\t402277\nGI\t4734\nPA\t21495\nTD\t6621\nRP\t109485\nAG\t27038\nDJ\t8400\nMC\t2191\nHA\t13101\nBA\t21137\nJO\t92532\nET\t25279\nSG\t15058\nEI\t231392\nBF\t15492\nIT\t624498\nCU\t65579\nFO\t104\nMV\t5036\nVM\t81487\nSE\t1501\nBG\t103488\nFJ\t11917\nWS\t3070\nKU\t47600\nUK\t1315786\nCJ\t1581\nCW\t250\nFM\t605\nLO\t20818\nMH\t2466\nMU\t33854\nPE\t113122\nOS\t15072\nLS\t921\nHQ\t7\nMZ\t14256\nLG\t29450\nLE\t123490\nQA\t78879\nDO\t3090\nTH\t116703\nEG\t350343\nSH\t93\nCS\t9094\nMF\t411\nGY\t6130\nFP\t397\nCE\t28045\nVC\t1667\nRN\t402\nSN\t75399\nTX\t8129\nCB\t13666\nNZ\t51227\nBT\t2378\nKN\t215961\nYM\t95924\nHU\t65262\nKE\t107590\nCY\t42563\nSI\t21114\nML\t58781\nEZ\t48981\nGP\t5963\nUG\t16725\nGA\t6245\nAS\t325975\nBE\t237236\nWZ\t1138\nMA\t6330\nAC\t1711\nKS\t252662\nNI\t201797\nAN\t3621\nKG\t12308\nTT\t2182\nBO\t41529\nNO\t72035\nSY\t563457\nER\t4395\nJQ\t2\nCO\t161050\nIM\t180\nIZ\t185238\nUY\t23119\nOC\t787\nNG\t44806\nJE\t16745\nCF\t63939\nAR\t119902\nEU\t2\nRM\t656\nTK\t820\nLU\t13992\nSZ\t187385\nNF\t15\nIS\t1354607\nMP\t33455\nAF\t236103\nJA\t283529\nBB\t2265\nCQ\t141\nPP\t2881\nCD\t53430\nAO\t16391\nST\t1751\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1579805014607_-251352432","id":"20200123-085546_800023469","dateCreated":"2020-01-23T18:43:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:266","dateFinished":"2020-01-23T19:58:29+0000","dateStarted":"2020-01-23T19:58:09+0000"},{"text":"// Display number of events by day\nz.show(query1.select(\"date\",\"count_events\").groupBy(\"date\").agg(sum(\"count_events\").alias(\"number of events\")).filter($\"date\".startsWith(\"2019\")))","user":"anonymous","dateUpdated":"2020-01-23T20:05:31+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"date":"string","number of events":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"date","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"number of events","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"date\tnumber of events\n20190112\t735304\n20190111\t1032446\n20190113\t661828\n20190126\t748513\n20190121\t984998\n20190123\t1145431\n20190109\t1143080\n20190115\t1210917\n20190130\t1108423\n20190108\t1067380\n20190102\t734622\n20190106\t589698\n20190119\t825287\n20190128\t963920\n20190118\t1099920\n20190107\t887144\n20190125\t1105917\n20190122\t1067165\n20190104\t853252\n20190127\t708400\n20190101\t524871\n20190131\t1070550\n20190110\t1133001\n20190120\t665556\n20190105\t586099\n20190114\t1037401\n20190129\t1171231\n20190103\t866156\n20190124\t1241365\n20190117\t1132032\n20190116\t1204444\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1579805014607_-165427966","id":"20200123-085639_223947056","dateCreated":"2020-01-23T18:43:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:267","dateFinished":"2020-01-23T20:05:51+0000","dateStarted":"2020-01-23T20:05:31+0000"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579810416703_-463076999","id":"20200123-201336_1756132991","dateCreated":"2020-01-23T20:13:36+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3384","text":"// ************************ QUERY 2 ********************************","dateUpdated":"2020-01-23T20:13:44+0000"},{"user":"anonymous","dateUpdated":"2020-01-23T20:22:06+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579805014608_388915729","id":"20200123-103654_1317580592","dateCreated":"2020-01-23T18:43:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:268","dateFinished":"2020-01-23T20:22:07+0000","dateStarted":"2020-01-23T20:22:06+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"query2: org.apache.spark.sql.DataFrame = [country: string, year: int ... 4 more fields]\n"}]},"text":"val query2 = spark.read\n      .cassandraFormat(\"country_events\", \"gdelt\")\n      .load()"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"country":"string","number of mentions":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"pieChart":{},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"day","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"sum(num_mentions)","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579810038795_-371848889","id":"20200123-200718_891033695","dateCreated":"2020-01-23T20:07:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3267","text":"// Display number of mentions / day for Italy\nz.show(query2.filter($\"country\"===\"IT\").select(\"day\",\"num_mentions\").groupBy(\"day\").agg(sum(\"num_mentions\")))","dateUpdated":"2020-01-23T20:43:34+0000","dateFinished":"2020-01-23T20:41:56+0000","dateStarted":"2020-01-23T20:41:54+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"day\tsum(num_mentions)\n31\t3\n28\t3\n26\t3\n27\t3\n12\t3\n22\t3\n1\t2\n13\t3\n6\t3\n16\t3\n3\t3\n20\t3\n5\t3\n19\t3\n15\t3\n9\t3\n17\t3\n4\t4\n8\t3\n23\t3\n7\t3\n10\t3\n25\t3\n24\t3\n29\t3\n21\t4\n11\t3\n14\t3\n2\t2\n30\t3\n18\t3\n"},{"type":"TEXT","data":""}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579811488639_1409665710","id":"20200123-203128_1941195319","dateCreated":"2020-01-23T20:31:28+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3718"}],"name":"gdeltFinal","id":"2EXKX771G","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}